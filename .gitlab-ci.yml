stages:
  - build
  - test
  - deploy

compile:
  stage: build
  script: mvn package -Dmaven.test.skip=true
  artifacts:
    paths:
      - target/

test:
  stage: test
  script: mvn test

run_on_vm:
  stage: deploy
  variables:
    PORT: 5000
  script:
    - sh target/bin/simplewebapp &>/dev/null &
    - dpl --provider=heroku --app=cg3417-simplewebapp --api-key=$HEROKU_API_KEY
